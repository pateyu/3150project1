.def temp = r16

; Replace with your application code
RESET:
    ldi temp, 0b00000001  ; Set PD0 as output
    out DDRD, temp

    ldi temp, 0b11111111  ; Turn off LED initially
    out PORTD, temp

    cbi DDRA, 6           ; Configure PA6 as input
    sbi PORTA, 6          ; Enable pull-up resistor on PA6s

MAIN_LOOP:
    sbic PINA, 6
    rjmp MAIN_LOOP
    call DELAY            ; Debounce
    rjmp CHECK_BUTTON_RELEASE

CHECK_BUTTON_RELEASE:
    sbis PINA, 6          ; Check if the button is released
    rjmp CHECK_BUTTON_RELEASE
    rjmp SOS_SIGNAL

SOS_SIGNAL:
    call DOT
    call SPACE
    call DOT
    call SPACE
    call DOT
    call SPACE
    call DASH
    call SPACE
    call DASH
    call SPACE
    call DASH
    call SPACE
    call DOT
    call SPACE
    call DOT
    call SPACE
    call DOT
    rjmp MAIN_LOOP

DOT:
    ldi temp, 0b11111110  ; Turn on LED
    out PORTD, temp
    call DELAY
    ldi temp, 0b11111111  ; Turn off LED
    out PORTD, temp
    ret

DASH:
    ldi temp, 0b11111110  ; Turn on LED
    out PORTD, temp
    call DELAY
    call DELAY            ; Longer delay for DASH
    ldi temp, 0b11111111  ; Turn off LED
    out PORTD, temp
    ret

SPACE:
    call DELAY
    ret

DELAY:
    LDI R19, 255
LOOP1:
    LDI R20, 255
LOOP2:
    LDI R21, 50
LOOP3:
    NOP
    DEC R21
    BRNE LOOP3
    DEC R20
    BRNE LOOP2
    DEC R19
    BRNE LOOP1
    ret
